import Tkinter
from Tkinter import *
import tkMessageBox
import tkFileDialog
from tkFileDialog import askopenfilenamefrom 
import Tkconstants
from WavSteg import hide_data
from WavSteg import recover_data
from WavSteg import usage
import os

#Function that shifts characters in 'message' based on a give number 'shift'
def helper(msg, shift):
    #Set string to lower case
	msg = msg.lower()
	#Set string to hold characters
	code = ""
	
	#Encrypt String
	for c in msg:
		if c in "abcdefghijklmnopqrstuvwxyz":
			num = ord(c)
			num += shift
			# wrap list if necessary
 			if num > ord("z"):
				num -= 26
			elif num < ord("a"):
				num += 26
			code = code + chr(num)
		#Only modify letters
		else:
#		code = code + c
	return code

#Encrypts the string and returns the result.
def encrypt(msg):
	return helper(message, 3)

#Decrypts the string and returns the result.
def decrypt(msg):
	return helper(msg, -3)

#---------------GUI------------------
def openfile():
    filename = askopenfilename()
    file_opt = options = {}
    options['filetypes'] = [('all files', '.*'), ('wav files', '.wav')]
    f=open(filename)
    f.read()
    print tkFileDialog.askopenfilename()
	

def displayText():
     #Display the Entry text value. 
    global entryWidget


    if entryWidget.get().strip() == "":
         tkMessageBox.showerror("Tkinter Entry Widget", "Enter Secret Message")
    else:
         tkMessageBox.showinfo("Tkinter Entry Widget", "Secret Message =" + entryWidget.get().strip())
         f = open("Message.txt","w")
         path = 'Message.txt'
         f.write(entryWidget.get().strip()) 
         f.close()


if __name__ == "__main__":     
   
    root = Tk()
 
root.title("Tkinter Entry Widget")
root["padx"] = 40
root["pady"] = 20   
     #CReate a text frame to hold the text label and the entry widget
textFrame = Frame(root) 
     #Create a label in text frame
entryLabel = Label(textFrame)
entryLabel["text"] = "Enter the text:"
entryLabel.pack(side=LEFT)
  #create an  entry textframe
entryWidget = Entry(textFrame)
entryWidget["width"] = 50
entryWidget.pack(side=LEFT)
textFrame.pack()

button = Button(root, text="Submit", command=displayText)
button.pack()

root.mainloop()
#--------------/GUI--------------------

#Create StringLength variable for later use
strLength = 0
#path = 'Test.txt'

#Collect string to encrypt
f = open(path, 'r')
msg = f.read()
f.close()

#Remove file
os.remove(path)


#Collect length of the string
strLength = len(msg)
#Place encrypted message in code variable
code = encrypt(msg)

#Write encrypted message to file
if len(code) > 0:
    fe = open(path, 'w')
    fe.write(code)
    fe.close()

#Hide data in wav file	
hide_data(filename, path, "Hidden.wav", 1)


#Recover data from wav file
recover_data(filename, "Recovered.txt", 1, 4)

#Collect string to encrypt
f = open("Recovered.txt", 'r')
msg = f.read()
f.close()

#Remove file
os.remove("Recovered.txt")

#Place decrypted message in code variable
code = decrypt(msg)
#Write encrypted message to file
if len(code) > 0:
    fe = open("DeCrypted.txt", 'w')
    fe.write(code)
    fe.close()


print ("Done")
